{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Cargos e Responsabilidades{% endblock title %}

{% block content %}

<h2>üóÇÔ∏è Cargos e Responsabilidades</h2>

<form method="get" class="my-4">
    <div class="row g-3">
        
        <!-- Busca por nome -->
        <div class="col-md-8">
            <label class="form-label">Pesquisar:</label>
            <div class="input-group">
                <input
                    type="text"
                    name="q"
                    class="form-control"
                    placeholder="Buscar por nome ou descri√ß√£o..."
                    value="{{ request.GET.q }}"
                >
                <button class="btn btn-primary" type="submit">Buscar</button>
            </div>
        </div>

    </div>
</form>

{% if functions %}

    {% for func in functions %}
        <div class="accordion mb-2" id="accordion-cargo-{{ func.pk }}">
            <div class="accordion-item">
                <h2 class="accordion-header" id="heading-{{ func.pk }}">
                    <button
                        class="accordion-button collapsed"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#collapse-{{ func.pk }}"
                        aria-expanded="false"
                        aria-controls="collapse-{{ func.pk }}"
                    >
                        {{ func.name }}
                    </button>
                </h2>

                <div
                    id="collapse-{{ func.pk }}"
                    class="accordion-collapse collapse"
                    aria-labelledby="heading-{{ func.pk }}"
                    data-bs-parent="#accordion-cargo-{{ func.pk }}"
                >
                    <div class="accordion-body">
                        <div class="mb-2">
                            <strong>Exig√™ncias:</strong><br>
                            {% with level=func.education_level %}
                                {% if level == "FUNDAMENTAL" %}
                                    <span class="badge bg-secondary">
                                        Ensino Fundamental
                                    </span>
                                {% elif level == "MEDIO" %}
                                    <span class="badge bg-info text-dark">
                                        Ensino M√©dio
                                    </span>
                                {% elif level == "TECNICO" %}
                                    <span class="badge bg-warning text-dark">
                                        Ensino T√©cnico
                                    </span>
                                {% elif level == "SUPERIOR" %}
                                    <span class="badge bg-success">
                                        Ensino Superior
                                    </span>
                                {% endif %}
                            {% endwith %}

                            <span class="ms-2 text-muted">
                                <i class="bi bi-clock"></i>
                                {{ func.workload }} horas semanais
                            </span>
                        </div>

                        <p>
                            <strong>Responsabilidades:</strong><br>
                            {{ func.description|safe }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}


{% else %}
    <div class="text-center my-4">
        <div class="col-12 col-md-6 mx-auto">
            <div class="alert alert-info" role="alert">
                Nenhuma cargo encontrado.
            </div>
        </div>
    </div>
{% endif %}

{% endblock content %}
